---
config:
  layout: elk
---
flowchart TB
    %% =========================
    %% 중앙 플로우 (손님 대기 등록)
    %% =========================
    S(["시작"])

    C1["대기 현황 화면 표시"]
    C2["대기 등록 선택"]

    subgraph FORM["대기 등록 입력"]
        I1[/"이름 입력"/]
        I2[/"전화번호 입력(필수)"/]
        I3[/"인원 수 입력"/]
    end

    D1{"필수값 누락?<br/>(이름/전화번호)"}
    A1@{shape: doc, label: "[알럿]<br/>필수 정보를 입력해 주세요"}

    D2{"중복 대기 존재?<br/>(전화번호 기준)"}
    A2@{shape: doc, label: "[알럿]<br/>이미 대기 등록이 있습니다"}

    X1["대기 번호 발급"]
    X2["대기 등록 저장<br/>(status=WAITING)"]

    O1@{shape: doc, label: "[안내]<br/>대기 등록 완료"}

    E(["종료"])

    %% =========================
    %% 중앙 플로우 연결
    %% =========================
    S --> C1 --> C2 --> I1
    I1 --> I2 --> I3 --> D1

    D1 -- "예" --> A1 --> I1
    D1 -- "아니오" --> D2

    D2 -- "예" --> A2 --> E
    D2 -- "아니오" --> X1 --> X2 --> O1 --> E

    %% =========================
    %% DB 테이블 (우측 여백 주석 영역)
    %% =========================
    subgraph DB_LABELS["DB 테이블 (참조/저장)"]
        DB_WAIT@{shape: rect, label: "[DB]<br/>WAITING_LISTS"}
        DB_STORE@{shape: rect, label: "[DB]<br/>STORES"}
    end

    %% =========================
    %% DB 연결 (설명용 점선)
    %% =========================
    D2 -.-> DB_WAIT
    X2 -.-> DB_WAIT

    C1 -.-> DB_STORE

    %% =========================
    %% DB 스타일 강조
    %% =========================
    style DB_WAIT  fill:#FFF8E1,stroke:#F9A825,stroke-width:1px
    style DB_STORE fill:#FFF8E1,stroke:#F9A825,stroke-width:1px