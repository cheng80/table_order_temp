# Table Order System – Core Technical Specification (V07)

본 문서는 **플로우차트(F00~F06)** 및 **DB 테이블 스펙 문서(08번)**를 *별도 기준 문서*로 유지하는 전제 하에,
그 외에 흩어져 있던 기술 문서(기획·화면·로직·인증)를 **하나의 코어 기술 문서**로 통합한 결과물이다.

> 이 문서 하나만 읽어도
> - 시스템이 왜 이렇게 설계되었는지
> - 각 기능의 책임과 경계가 무엇인지
> - 구현 시 지켜야 할 기술적·운영적 원칙이 무엇인지
> 를 이해할 수 있도록 구성한다.

---

## Chapter 1. 시스템 정체성과 설계 방향

이 시스템은 단순한 테이블오더 앱이 아니라,
**주문·결제 + 대기열 + 운영 판단 데이터**를 함께 다루는 *매장 운영 중심 시스템*이다.

핵심 설계 방향은 다음과 같다.

- 자동화보다 **운영자의 명시적 제어**를 우선한다.
- 모든 데이터는 “실시간 처리 결과”가 아니라 **운영 기록**으로 남긴다.
- 기능 편의성보다 **운영 안정성과 복구 가능성**을 중시한다.

---

## Chapter 2. 사용자 역할과 권한 경계

### 2.1 사용자 역할

| 역할 | 설명 |
| --- | --- |
| OWNER | 점주. 매장 설정 및 모든 운영 제어 권한 |
| STAFF | 직원. 제한된 운영 기능 수행 |
| CUSTOMER | 손님. 인증 없이 대기 및 주문 가능 |

### 2.2 역할 분리 원칙

- 손님은 **상태를 변경하지 않는다**.
- 모든 상태 변화(대기 호출, 입장, 노쇼, 마감)는 점주/직원의 조작으로만 발생한다.
- 시스템은 판단을 보조하지만 결정을 대신하지 않는다.

---

## Chapter 3. 화면 설계 및 UX 책임 원칙

### 3.1 화면 설계 3대 원칙

1. **한 화면 = 하나의 책임**
2. 자동 처리 대신 **명시적 조작**
3. 손님 화면은 단순하게, 점주 화면은 제어 중심으로

### 3.2 화면 그룹 개념

- 운영 화면: 점주/직원이 매장 상태를 제어
- 대기 화면: 대기 현황 확인 및 등록
- 주문 화면: 메뉴·옵션 선택 및 주문 구성

### 3.3 대기 화면 분리 개념

- W-01: 점주 대기 관리 화면 (조회·호출·확정)
- W-02: 손님 대기 현황/등록 화면

---

## Chapter 4. 핵심 비즈니스 로직 설계

### 4.1 대기열 로직 핵심 규칙

- 대기열은 **만석 여부와 무관하게** 생성 가능하다.
- 예상 대기 시간은 참고 정보일 뿐, 로직 분기 기준이 아니다.
- 호출은 자동이 아니며, 점주의 명시적 호출로만 진행된다.
- 대기자는 특정 테이블과 직접 연결되지 않는다.

### 4.2 주문 및 옵션 로직

- 주문은 메뉴와 직접 연결되지 않는다.
- 주문 구성의 기준은 항상 **주문 상세 단위**이다.
- 옵션은 필수/선택으로 구분되며, 필수 옵션 검증은 UI 단계에서 수행된다.

### 4.3 결제 및 스냅샷 전략

- 결제 시점의 가격과 원가는 **스냅샷**으로 저장된다.
- 이후 가격 변경이 발생해도 과거 주문 데이터는 영향을 받지 않는다.

### 4.4 날씨 데이터의 위치

- 날씨 데이터는 운영 통계용 보조 데이터이다.
- 주문 로직이나 자동 제어에는 사용하지 않는다.

---

## Chapter 5. 인증 및 운영 안정성 설계

### 5.1 점주 인증

- 점주는 계정 기반 인증을 통해 시스템에 접근한다.
- 운영 관련 기능은 인증 이후에만 활성화된다.

### 5.2 기기 모드 및 PIN 개념

- 손님용 화면에서 점주 화면으로 전환 시 인증(PIN)이 필요하다.
- 이는 오작동 및 무단 조작을 방지하기 위한 장치이다.

### 5.3 실수 허용과 복구 철학

- 운영 중 실수는 발생할 수 있다고 전제한다.
- 취소, 재등록, 재호출이 가능하도록 설계한다.
- 자동 복구보다 **운영자의 재조작**을 허용한다.

---

## Chapter 6. 일일 운영 기준과 데이터 정리 정책

- 하루 운영의 기준 시각은 자정(00:00)이다.
- 자정에 자동으로 실행되는 배치 작업은 존재하지 않는다.
- 전일 데이터 정리는 다음날 앱 진입 시점에 수행된다.
- 마감은 항상 점주의 명시적 확인을 통해서만 완료된다.

---

## 문서 사용 가이드

- 플로우 동작 이해: **F00~F06 플로우차트 문서 참조**
- 데이터 구조 이해: **08_DB_테이블_스펙 문서 참조**
- 본 문서는 위 두 문서를 연결하는 **코어 기술 설명서** 역할을 수행한다.

