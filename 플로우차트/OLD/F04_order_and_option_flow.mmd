---
config:
  layout: elk
---
flowchart TB
    S(["시작"])

    subgraph CUSTOMER["손님"]
        P1["메뉴 화면 표시"]
        I1[/"메뉴 선택"/]

        P2["옵션 선택 화면 표시"]
        subgraph FORM["옵션 선택 폼"]
            I2[/"필수 옵션 선택"/]
            I3[/"선택 옵션 선택"/]
        end

        P3["선택 완료"]
        P4["주문 확인 화면 표시"]
        I4[/"주문 확정 버튼"/]
    end

    subgraph SYSTEM["시스템"]
        X1["선택 항목 구성"]
        D1{"필수 옵션이<br/>모두 선택됨?"}
        A1@{shape: doc,label: "[시스템 알럿]<br/>필수 옵션을 선택해 주세요."}

        D2{"추가 주문이<br/>필요한가?"}
        X2["주문 항목 추가"]
        X3["주문 생성<br/>상태: OPEN"]
        O1@{shape: doc,label: "[안내]<br/>주문이 접수되었습니다."}
    end

    E(["종료"])

    %% 입력 흐름
    I2 --> I3

    %% 메인 플로우
    S --> P1 --> I1 --> P2 --> I2
    I3 --> P3 --> X1 --> D1

    %% 필수 옵션 검증
    D1 -- "아니오" --> A1 --> P2
    D1 -- "예" --> P4 --> I4 --> D2

    %% 추가 주문 분기
    D2 -- "예" --> X2 --> P1
    D2 -- "아니오" --> X3 --> O1 --> E