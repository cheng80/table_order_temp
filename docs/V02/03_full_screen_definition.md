# [설계] 테이블오더 시스템 통합 화면 설계서 (v3.1)

> **문서 기준:** 02_table_order_system_planning.md (기획서 완전 일치 버전)
> **화면 개수:** 총 13개 화면 (점주 7 + 테이블 5 + 주방 1)
> **작성 목적:** 기획서에 명시된 모든 기능(회원가입, 배너, 보안진입 등)의 UI/UX 정의
> **수정 사항:** 인증 토큰 방식을 JWT에서 UUID로 변경 (v3.1)

---

## 1. 화면 목록 (Screen List)

기획서의 `4. 시스템 구성` 항목을 기준으로 화면 ID를 부여함.

| 분류 | ID | 화면명 | 기획서 매핑 | 핵심 기능 |
| :--- | :--- | :--- | :--- | :--- |
| **계정** | **A-01** | **회원가입** | 4-1. 1) 점주 회원 가입 | 사업자번호 검증, 계정 생성 |
| | **A-02** | **로그인** | 4-1. 2) 점주 로그인 | ID/PW 인증, 자동로그인 |
| **점주** | **O-01** | **메인(대시보드)** | 4-1. 3) 점주 메인 | 드로워 메뉴, 매장 현황, 모드 실행 버튼 |
| | **O-02** | **메뉴 관리(목록)** | 4-1. 3) 메뉴 관리 | 메뉴 On/Off, 품절 토글, 가격 수정 진입 |
| | **O-03** | **메뉴 등록(상세)** | 4-1. 3) 메뉴 등록 | 이미지 업로드, 이름/설명/가격 입력 |
| | **O-04** | **배너 관리** | 4-1. 3) 배너 등록 | 홍보용 이미지 등록/삭제, 노출 여부 |
| | **O-05** | **테이블 관리** | 4-1. 3) 매장 테이블 | 전체 좌석 수 설정, QR/ID 확인 |
| | **O-06** | **문의하기** | 4-1. 3) 문의하기 | 시스템 관리자에게 1:1 문의 전송 |
| **테이블** | **T-01** | **메인 주문판** | 4-2. 메뉴 화면 | 카테고리, 메뉴 리스트, 배너 슬라이드 |
| | **T-02** | **옵션 상세** | 4-2. 주문(장바구니) | 필수/선택 옵션, 수량 조절 |
| | **T-03** | **장바구니/결제** | 4-2. 결제 | 주문 내역 확인, PG 결제 호출 |
| | **T-04** | **직원 호출** | (기능 상세) | 물, 앞치마 등 프리셋 요청 |
| | **T-05** | **관리자 인증** | 4-4. 운영 화면 접근 | **[보안]** 비밀번호 입력 후 점주 모드 복귀 |
| **주방** | **K-01** | **KDS 메인** | 4-3. 주방용 KDS | 주문 티켓 확인, 조리 상태 변경 |

---

## 2. 화면별 상세 명세 (Detailed Specs)

### [Group A] 계정 및 진입 (Auth)

#### A-01. 점주 회원가입
* **Input:** 사업자등록번호(10자리), 이메일(ID), 비밀번호, 비밀번호 확인, 점주명, 휴대폰번호.
* **Logic:**
    * 사업자번호 입력 후 [검증] 버튼 → 서버 API로 유효성 체크 (형식 검사).
    * 모든 필드 유효성 통과 시 [가입하기] 활성화.

#### A-02. 점주 로그인
* **Input:** 이메일, 비밀번호.
* **Action:** 로그인 성공 시 `O-01`(점주 메인)으로 이동.
* **Token:** **UUID 토큰**을 Secure Storage에 저장하여 앱 재실행 시 자동 로그인 처리.

---

### [Group O] 점주 앱 - 운영/관리 (Owner)

#### O-01. 점주 메인 (대시보드)
* **Structure:** `Scaffold` + `Drawer`(햄버거 메뉴).
* **Body:**
    * **상단:** 매장명, 영업 상태(영업중/마감) 스위치.
    * **중앙 (바로가기):**
        * [테이블 모드 실행]: 현재 기기를 손님용 메뉴판으로 전환.
        * [KDS 모드 실행]: 현재 기기를 주방용 화면으로 전환.
    * **하단:** 금일 매출 요약 (간략).
* **Drawer Menu:** 메뉴 관리, 배너 관리, 테이블 관리, 문의하기, 로그아웃.

#### O-02. 메뉴 관리 (List)
* **UI:** 카테고리별 탭 + 리스트뷰.
* **Item:** 썸네일, 메뉴명, 가격.
* **Action:**
    * **품절 스위치:** 즉시 품절 처리 (MQTT 전파).
    * **숨김 스위치:** 메뉴판에서 아예 안 보이게 처리 (On/Off).
    * **FAB(+):** `O-03` 화면으로 이동.

#### O-03. 메뉴 등록/수정 (Form)
* **Input:**
    * 사진 등록 (Image Picker).
    * 카테고리 선택 (Dropdown).
    * 메뉴명, 설명.
    * 가격 (정상가 / 할인가 입력 가능).
* **Save:** [저장] 시 서버 DB 반영 및 메뉴판 갱신.

#### O-04. 배너 관리
* **UI:** 등록된 배너 리스트 (이미지 + 순서).
* **Action:**
    * **[+ 배너 추가]:** 갤러리에서 홍보 이미지 업로드.
    * **활성 스위치:** 특정 배너를 잠시 끄거나 켤 수 있음.
* **Effect:** 여기서 등록한 이미지는 `T-01` 테이블 화면 상단에 슬라이드로 노출됨.

#### O-05. 테이블 관리
* **Input:**
    * **총 테이블 수:** (예: 10개 입력).
    * **테이블 번호 설정:** 1번~10번 자동 생성.
* **Display:** 각 테이블별 고유 ID 또는 QR코드 값 표시 (초기 세팅용).

---

### [Group T] 손님용 테이블 메뉴판 (Table)

#### T-01. 메인 주문판
* **Layout:**
    * **Top:** **(신규)** 배너 슬라이드 (`O-04`에서 등록한 이미지).
    * **Left:** 카테고리 탭.
    * **Center:** 메뉴 그리드.
    * **Right:** 장바구니 요약.
* **Interaction:**
    * 배너 영역은 일정 시간마다 자동 롤링.
    * 메뉴 터치 시 `T-02` 팝업.

#### T-02. 옵션 상세
* **UI:** 메뉴 이미지, 수량 조절(+, -), 옵션 리스트(Check/Radio).
* **Logic:** 필수 옵션 미선택 시 [담기] 버튼 비활성.

#### T-03. 장바구니/결제
* **List:** 담은 메뉴 목록, 총 금액 표시.
* **Action:** [결제하기] → PG사 결제 모듈 호출.

#### T-04. 직원 호출
* **UI:** 그리드 형태의 호출 옵션 (물, 수저, 앞치마, 기타 등).
* **Action:** 선택 시 KDS 또는 포스기로 알림 전송.

#### T-05. 관리자 인증 (Admin Exit) **[중요]**
* **Trigger:** 기획서 `4-4`에 따라, 손님이 실수로 나가지 못하도록 숨겨진 제스처 사용.
    * 예: 로고 5회 터치 or 우측 상단 구석 롱프레스.
* **UI:** 풀스크린 숫자 키패드 (비밀번호 입력 창).
* **Logic:**
    * 점주 비밀번호(또는 설정한 PIN) 일치 시: 앱이 `O-01`(점주 메인)으로 복귀.
    * 불일치 시: "비밀번호가 올바르지 않습니다" 토스트 후 유지.

---

### [Group K] 주방용 화면 (KDS)

#### K-01. KDS 메인
* **UI:** 주문 티켓 가로 나열 (Horizontal List).
* **Ticket Data:** 테이블번호, 주문시각(경과시간 타이머), 메뉴상세, 옵션.
* **Status Action:**
    * [접수] → [조리중] → [완료].
    * 완료 처리된 티켓은 화면에서 사라지거나 '완료됨' 탭으로 이동.

---

## 3. 핵심 시나리오 워크플로우 (Scenario)

기획서의 흐름을 반영한 실제 앱 구동 순서.

```mermaid
sequenceDiagram
    participant Owner as 점주
    participant Device as 태블릿(앱)
    participant Server as 서버
    participant Customer as 손님

    Note over Owner, Device: 1. 초기 세팅 (점주 모드)
    Owner->>Device: A-01 회원가입 & A-02 로그인
    Owner->>Device: O-05 테이블 수 설정 (예: 5번 테이블)
    Owner->>Device: O-03 메뉴 & O-04 배너 등록
    
    Note over Owner, Device: 2. 영업 개시 (테이블 모드 전환)
    Owner->>Device: O-01 메인에서 [테이블 모드 실행] 클릭
    Device->>Device: T-01 메인 주문판 로딩 (Full Screen)
    
    Note over Customer, Device: 3. 손님 주문
    Customer->>Device: 메뉴 탐색 및 T-03 결제
    Device->>Server: 주문 전송
    
    Note over Owner, Device: 4. 영업 마감 (관리자 복귀)
    Owner->>Device: 숨겨진 버튼(로고) 5회 터치
    Device->>Device: T-05 관리자 비밀번호 입력창 호출
    Owner->>Device: 비밀번호 입력
    Device->>Device: O-01 점주 메인 화면으로 복귀