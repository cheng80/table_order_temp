# 메뉴–옵션 매핑 구조 이해를 위한 더미 데이터 예시 (V03 기준)

이 문서는 \*\*최신 V03 설계 문서(우마이 카레 시나리오)\*\*를 기준으로, 메뉴·옵션·옵션그룹·메뉴–옵션 매핑 구조가 실제로 어떻게 동작하는지를 **더미 데이터와 함께 직관적으로 설명**하기 위한 기준 문서다.

이 문서 하나만 보면 다음을 이해할 수 있다.

- 옵션은 어디까지가 ‘정의’이고 어디부터가 ‘정책’인지
- 필수 옵션과 선택 옵션이 구조적으로 어떻게 구분되는지
- 특정 메뉴에만 옵션이 보이도록 만드는 핵심 포인트가 무엇인지

---

## 1. 시나리오 정의 (업종 페르소나)

### 매장 콘셉트

- 업종: **카레 전문점 – 우마이 카레**

### 메뉴 구성

- 기본 카레
- 치킨 카레
- 돈까스 카레

### 옵션 정책 (V03 반영)

- 모든 카레 메뉴에는 **맵기 조절 옵션이 반드시 존재**한다.
- 일부 카레 메뉴에는 **토핑 추가 옵션이 선택적으로 제공**된다.

> 핵심 요구사항
>
> - 맵기 조절은 모든 카레에 공통으로 노출 (필수)
> - 토핑 옵션은 허용된 메뉴에만 노출

---

## 2. MENU (메뉴)

> 메뉴는 ‘판매 대상’이며, 옵션 정보는 포함하지 않는다.

```sql
menu
----------------------------------------------------
menu_id | name        | price | cost
----------------------------------------------------
1       | 기본 카레   | 8000  | 3500
2       | 치킨 카레   | 9000  | 4200
3       | 돈까스 카레 | 10000 | 4800
```

### 설명

- `price` : 손님에게 판매되는 가격
- `cost`  : 해당 메뉴의 기준 원가 (V03 신규 개념)
- 옵션 노출 여부는 메뉴 테이블에서 **절대 결정하지 않는다**

---

## 3. OPTION\_GROUPS (옵션 그룹)

> 옵션 그룹은 **선택 UI 단위**이며, 매장 공용 자산이다.

```sql
option_groups
----------------------------------------------------------------
option_group_id | name       | is_exclusive | min_select | max_select
----------------------------------------------------------------
10              | 맵기 조절  | true         | 1          | 1
11              | 토핑 추가  | false        | 0          | 3
```

### 설명

- 맵기 조절
  - 반드시 1개 선택
  - 단일 선택 (라디오 버튼 성격)
- 토핑 추가
  - 선택 안 해도 됨
  - 복수 선택 가능

---

## 4. OPTIONS (옵션)

> 옵션 그룹 안에 들어가는 실제 선택지 정의

```sql
options
---------------------------------------------------------------------
option_id | option_group_id | name        | extra_price | extra_cost
---------------------------------------------------------------------
100       | 10              | 순한맛      | 0           | 0
101       | 10              | 보통맛      | 0           | 0
102       | 10              | 매운맛      | 0           | 0

110       | 11              | 치즈 추가   | 1000        | 400
111       | 11              | 계란 추가   | 800         | 300
112       | 11              | 소시지 추가 | 1200        | 500
```

### 설명

- `extra_price` : 옵션으로 인해 증가하는 판매가
- `extra_cost`  : 옵션으로 인해 증가하는 원가
- 이 단계까지는 \*\*"이 매장에 이런 옵션들이 존재한다"\*\*는 정의일 뿐이다.

---

## 5. MENU\_OPTION\_MAPPINGS (핵심 테이블)

> **어떤 메뉴에 어떤 옵션 그룹을 노출할지 결정하는 유일한 테이블**

```sql
menu_option_mappings
---------------------------------------------
mapping_id | menu_id | option_group_id
---------------------------------------------
1          | 1       | 10   -- 기본 카레 + 맵기 조절
2          | 1       | 11   -- 기본 카레 + 토핑 추가

3          | 2       | 10   -- 치킨 카레 + 맵기 조절
4          | 2       | 11   -- 치킨 카레 + 토핑 추가

5          | 3       | 10   -- 돈까스 카레 + 맵기 조절
```

### 핵심 포인트

- **돈까스 카레(menu\_id = 3)** 는 토핑 옵션이 존재함에도 불구하고 매핑이 없기 때문에 화면에 노출되지 않는다.

---

## 6. 최종 화면 노출 결과

### 기본 카레 / 치킨 카레

- 맵기 조절 (필수)
- 토핑 추가 (선택)

### 돈까스 카레

- 맵기 조절 (필수)
- 토핑 옵션 없음

> 토핑이 보이지 않는 이유는 단 하나 `menu_option_mappings`에 데이터가 없기 때문이다.

---

## 7. 구조를 한 문장으로 요약

> **옵션과 옵션그룹은 ‘존재’를 정의하고**\
> **메뉴–옵션 매핑은 ‘노출 정책’을 결정한다**

---

## 8. 이 구조의 장점 (V03 관점)

- 필수/선택 옵션을 DB 구조만으로 명확히 표현 가능
- 하나의 옵션 그룹을 여러 메뉴에서 재사용 가능
- 메뉴별 옵션 노출 정책을 유연하게 변경 가능
- 주문 시점에는 가격·원가 스냅샷으로 고정되어 이후 가격 변경이나 원가 변경과 완전히 분리됨

---

## 9. 다음 문서와의 연결 지점

- 주문 시점에는 이 구조를 기반으로 `order_details`, `order_detail_options`에 **가격·원가 스냅샷 데이터가 저장**된다.
- 이 스냅샷 데이터가 결제, KDS, 순이익 통계의 기준이 된다.

이 문서는 **V03 전체 문서(01\~07)를 관통하는 옵션 구조 기준 문서**로 사용한다.

